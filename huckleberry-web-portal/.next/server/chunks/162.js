exports.id=162,exports.ids=[162],exports.modules={179:(a,b,c)=>{Promise.resolve().then(c.bind(c,38876)),Promise.resolve().then(c.bind(c,84810))},342:(a,b,c)=>{Promise.resolve().then(c.bind(c,75625)),Promise.resolve().then(c.bind(c,6935)),Promise.resolve().then(c.t.bind(c,3991,23))},2251:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},6935:(a,b,c)=>{"use strict";c.d(b,{ThemeToggle:()=>h});var d=c(21124),e=c(38301),f=c(78226),g=c(88077);function h(){let[a,b]=(0,e.useState)(!0),[c,h]=(0,e.useState)(!1);return c?(0,d.jsxs)("button",{onClick:function(){let c=!a;b(c),document.documentElement.classList.toggle("dark",c),localStorage.setItem("theme",c?"dark":"light")},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md border bg-white text-gray-800 hover:bg-gray-50 dark:bg-neutral-900 dark:text-neutral-100 dark:border-neutral-800 dark:hover:bg-neutral-800",title:"Toggle theme",children:[a?(0,d.jsx)(g.A,{size:16}):(0,d.jsx)(f.A,{size:16}),(0,d.jsx)("span",{className:"text-sm",children:a?"Light":"Dark"})]}):(0,d.jsxs)("button",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md border bg-white text-gray-800 hover:bg-gray-50 dark:bg-neutral-900 dark:text-neutral-100 dark:border-neutral-800 dark:hover:bg-neutral-800",title:"Toggle theme",disabled:!0,children:[(0,d.jsx)(f.A,{size:16}),(0,d.jsx)("span",{className:"text-sm",children:"Dark"})]})}},8095:(a,b,c)=>{"use strict";c.d(b,{SignOutButton:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call SignOutButton() from the server but SignOutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\dlito\\Discord Huckleberry Mentorship Bot\\huckleberry-mentorship-bot\\huckleberry-web-portal\\components\\SignOutButton.tsx","SignOutButton")},10869:(a,b,c)=>{"use strict";c.d(b,{i:()=>n});var d=c(21124),e=c(38301),f=c(61398),g=c(83200),h=c(40822),i=c(6375),j=c(8015),k=c(90447),l=c(93400),m=c(77503);function n({images:a,onDelete:b,showDelete:c=!0,mentorshipId:n,sessionNoteId:o}){let[p,q]=(0,e.useState)(null),[r,s]=(0,e.useState)(null),[t,u]=(0,e.useState)(!1),[v,w]=(0,e.useState)(new Set),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)(!1);async function B(c,d){if(d?.stopPropagation(),b&&confirm("Are you sure you want to delete this image?")){q(c);try{let d=await fetch(`/api/images/${c}`,{method:"DELETE"});if(d.ok)b(c),null!==r&&a[r]?.id===c&&s(null),w(a=>{let b=new Set(a);return b.delete(c),b});else{let a=await d.json().catch(()=>({}));alert(a.error||"Failed to delete image")}}catch(a){console.error("Failed to delete image:",a),alert("Failed to delete image")}finally{q(null)}}}async function C(){if(0===v.size||!confirm(`Are you sure you want to delete ${v.size} image(s)?`))return;y(!0);let c=Array.from(v),d=await Promise.allSettled(c.map(a=>fetch(`/api/images/${a}`,{method:"DELETE"}))),e=[],f=[];d.forEach((a,b)=>{"fulfilled"===a.status&&a.value.ok?e.push(c[b]):f.push(c[b])}),b&&e.forEach(a=>b(a)),null!==r&&e.includes(a[r]?.id||"")&&s(null),w(new Set),u(!1),f.length>0?alert(`Failed to delete ${f.length} image(s). ${e.length} deleted successfully.`):alert(`Successfully deleted ${e.length} image(s).`),y(!1)}async function D(){if(n&&!z){A(!0);try{let a=new URLSearchParams({mentorshipId:n});o&&a.append("sessionNoteId",o);let b=await fetch(`/api/images/download?${a.toString()}`);if(!b.ok){let a=await b.json().catch(()=>({}));alert(a.error||"Failed to download images");return}let c=b.headers.get("Content-Disposition"),d=o?`session_images_${o}.zip`:`mentorship_images_${n}.zip`;if(c){let a=c.match(/filename="?(.+?)"?$/);a&&(d=a[1])}let e=await b.blob(),f=window.URL.createObjectURL(e),g=document.createElement("a");g.href=f,g.download=d,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(f),document.body.removeChild(g)}catch(a){console.error("Download error:",a),alert("Failed to download images. Please try again.")}finally{A(!1)}}}function E(){s(null)}function F(b){null!==r&&("prev"===b?s(r>0?r-1:a.length-1):"next"===b&&s(r<a.length-1?r+1:0))}if(0===a.length)return(0,d.jsx)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-neutral-900 bg-white dark:bg-neutral-950",children:(0,d.jsx)("p",{className:"text-sm text-gray-600 dark:text-neutral-400",children:"No images uploaded yet."})});let G=null!==r?a[r]:null,H=a.length>0&&v.size===a.length;return v.size>0&&(v.size,a.length),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,d.jsx)("div",{className:"flex items-center gap-3",children:c&&b&&(0,d.jsx)(d.Fragment,{children:t?(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("button",{onClick:()=>{u(!1),w(new Set)},className:"px-4 py-2 rounded-md border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-gray-700 dark:text-neutral-300 hover:bg-gray-50 dark:hover:bg-neutral-800 transition-colors",children:"Cancel"}),(0,d.jsx)("button",{onClick:function(){v.size===a.length?w(new Set):w(new Set(a.map(a=>a.id)))},className:"inline-flex items-center gap-2 px-4 py-2 rounded-md border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-gray-700 dark:text-neutral-300 hover:bg-gray-50 dark:hover:bg-neutral-800 transition-colors",children:H?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f.A,{size:18}),(0,d.jsx)("span",{children:"Deselect All"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.A,{size:18}),(0,d.jsx)("span",{children:"Select All"})]})}),v.size>0&&(0,d.jsxs)("button",{onClick:C,disabled:x,className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-red-600 dark:bg-red-500 text-white hover:bg-red-700 dark:hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)(h.A,{size:18}),(0,d.jsxs)("span",{children:["Delete ",v.size," Selected"]})]}),(0,d.jsxs)("span",{className:"text-sm text-gray-600 dark:text-neutral-400",children:[v.size," of ",a.length," selected"]})]}):(0,d.jsxs)("button",{onClick:()=>u(!0),className:"inline-flex items-center gap-2 px-4 py-2 rounded-md border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-gray-700 dark:text-neutral-300 hover:bg-gray-50 dark:hover:bg-neutral-800 transition-colors",children:[(0,d.jsx)(f.A,{size:18}),(0,d.jsx)("span",{children:"Select Images"})]})})}),n&&a.length>0&&(0,d.jsxs)("button",{onClick:D,disabled:z,className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-indigo-600 dark:bg-indigo-500 text-white hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)(i.A,{size:18}),(0,d.jsx)("span",{children:z?"Downloading...":"Download Images"})]})]}),(0,d.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:a.map((a,e)=>{let f=v.has(a.id);return(0,d.jsxs)("figure",{className:`relative rounded-md overflow-hidden border-2 bg-white dark:bg-neutral-950 group transition-all ${t&&f?"border-indigo-500 dark:border-indigo-400 ring-2 ring-indigo-500 dark:ring-indigo-400 ring-offset-2":"border-gray-200 dark:border-neutral-900 cursor-pointer"}`,onClick:()=>{if(t){var b;b=a.id,w(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})}else s(e)},children:[t&&(0,d.jsx)("div",{className:"absolute top-2 left-2 z-20",children:(0,d.jsx)("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center transition-colors ${f?"bg-indigo-600 dark:bg-indigo-500 border-indigo-600 dark:border-indigo-500":"bg-white/90 dark:bg-neutral-900/90 border-gray-300 dark:border-neutral-700"}`,children:f&&(0,d.jsx)(j.A,{size:16,className:"text-white"})})}),(0,d.jsx)("img",{src:a.thumbnail_url||a.image_url,alt:a.caption||"image",className:`w-full h-40 object-cover transition-opacity ${t&&f?"opacity-75":""}`,loading:"lazy"}),c&&b&&!t&&(0,d.jsx)("button",{onClick:b=>B(a.id,b),disabled:p===a.id,className:"absolute top-2 right-2 p-1.5 rounded-md bg-red-600 dark:bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-700 dark:hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed z-10",title:"Delete image",children:(0,d.jsx)(h.A,{size:16})}),a.caption&&(0,d.jsx)("figcaption",{className:"text-xs p-2 text-gray-600 dark:text-neutral-400",children:a.caption})]},a.id)})}),null!==r&&G&&(0,d.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 dark:bg-black/95 p-4",onClick:E,children:[(0,d.jsx)("button",{onClick:E,className:"absolute top-4 right-4 p-2 rounded-md bg-white/10 dark:bg-white/10 hover:bg-white/20 dark:hover:bg-white/20 text-white transition-colors z-10",title:"Close (ESC)",children:(0,d.jsx)(k.A,{size:24})}),(0,d.jsx)("button",{onClick:a=>{a.stopPropagation(),F("prev")},className:"absolute left-4 top-1/2 -translate-y-1/2 p-2 rounded-md bg-white/10 dark:bg-white/10 hover:bg-white/20 dark:hover:bg-white/20 text-white transition-colors z-10",title:"Previous (←)",children:(0,d.jsx)(l.A,{size:32})}),(0,d.jsx)("button",{onClick:a=>{a.stopPropagation(),F("next")},className:"absolute right-4 top-1/2 -translate-y-1/2 p-2 rounded-md bg-white/10 dark:bg-white/10 hover:bg-white/20 dark:hover:bg-white/20 text-white transition-colors z-10",title:"Next (→)",children:(0,d.jsx)(m.A,{size:32})}),(0,d.jsxs)("div",{className:"relative max-w-7xl max-h-full flex flex-col items-center",onClick:a=>a.stopPropagation(),children:[(0,d.jsx)("img",{src:G.image_url,alt:G.caption||"image",className:"max-w-full max-h-[90vh] object-contain"}),G.caption&&(0,d.jsx)("p",{className:"mt-4 text-white text-center max-w-2xl px-4",children:G.caption}),(0,d.jsxs)("p",{className:"mt-2 text-white/70 text-sm",children:[r+1," / ",a.length]})]})]})]})}},16953:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>h,metadata:()=>g});var d=c(75338);c(82704);var e=c(84810),f=c(38876);let g={title:"Huckleberry Mentorship Portal",description:"Web portal for students and instructors"};function h({children:a}){return(0,d.jsxs)("html",{lang:"en",children:[(0,d.jsx)("head",{children:(0,d.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})}),(0,d.jsx)("body",{suppressHydrationWarning:!0,children:(0,d.jsx)(f.SessionProviderWrapper,{children:(0,d.jsx)(e.ThemeProvider,{children:a})})})]})}},37131:(a,b,c)=>{Promise.resolve().then(c.bind(c,87822)),Promise.resolve().then(c.bind(c,88488))},38876:(a,b,c)=>{"use strict";c.d(b,{SessionProviderWrapper:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call SessionProviderWrapper() from the server but SessionProviderWrapper is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\dlito\\Discord Huckleberry Mentorship Bot\\huckleberry-mentorship-bot\\huckleberry-web-portal\\components\\SessionProviderWrapper.tsx","SessionProviderWrapper")},60590:(a,b,c)=>{Promise.resolve().then(c.bind(c,8095)),Promise.resolve().then(c.bind(c,68389)),Promise.resolve().then(c.t.bind(c,65169,23))},68389:(a,b,c)=>{"use strict";c.d(b,{ThemeToggle:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call ThemeToggle() from the server but ThemeToggle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\dlito\\Discord Huckleberry Mentorship Bot\\huckleberry-mentorship-bot\\huckleberry-web-portal\\components\\ThemeToggle.tsx","ThemeToggle")},75625:(a,b,c)=>{"use strict";c.d(b,{SignOutButton:()=>g});var d=c(21124),e=c(57461),f=c(81080);function g(){return(0,d.jsxs)("button",{onClick:()=>(0,e.signOut)({callbackUrl:"/"}),className:"w-full flex items-center gap-2 px-2 py-1.5 rounded-md text-sm text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-neutral-800 transition-colors",children:[(0,d.jsx)(f.A,{size:16}),(0,d.jsx)("span",{children:"Sign Out"})]})}},78275:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,34644,23)),Promise.resolve().then(c.bind(c,82146))},82704:()=>{},84810:(a,b,c)=>{"use strict";c.d(b,{ThemeProvider:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\dlito\\Discord Huckleberry Mentorship Bot\\huckleberry-mentorship-bot\\huckleberry-web-portal\\components\\ThemeProvider.tsx","ThemeProvider")},86457:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>k});var d=c(75338),e=c(65169),f=c.n(e),g=c(68389),h=c(8095),i=c(47025),j=c(86802);async function k({children:a}){let b=await (0,j.cookies)(),c=await (0,i.getToken)({req:{headers:{cookie:b.toString()}},secret:process.env.NEXTAUTH_SECRET}),e=String(c?.role||"unknown");return(0,d.jsxs)("div",{className:"min-h-screen grid grid-cols-[240px_1fr] bg-gray-50 dark:bg-neutral-950",children:[(0,d.jsxs)("aside",{className:"border-r border-gray-200 dark:border-neutral-900 bg-white dark:bg-neutral-950 p-4 flex flex-col",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,d.jsx)("h2",{className:"font-semibold text-gray-900 dark:text-white",children:"Portal"}),(0,d.jsx)(g.ThemeToggle,{})]}),(0,d.jsxs)("nav",{className:"grid gap-2 text-sm",children:[(0,d.jsx)(f(),{href:"/dashboard",className:"text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white hover:underline transition-colors",children:"Dashboard"}),(0,d.jsx)(f(),{href:"/sessions",className:"text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white hover:underline transition-colors",children:"Sessions"}),("instructor"===e||"admin"===e)&&(0,d.jsx)(f(),{href:"/instructor",className:"text-gray-700 dark:text-neutral-300 hover:text-gray-900 dark:hover:text-white hover:underline transition-colors",children:"Instructor"})]}),(0,d.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-neutral-800",children:(0,d.jsx)(h.SignOutButton,{})})]}),(0,d.jsx)("main",{className:"p-6 bg-gray-50 dark:bg-neutral-950",children:a})]})}},87822:(a,b,c)=>{"use strict";c.d(b,{SessionProviderWrapper:()=>f});var d=c(21124),e=c(57461);function f({children:a}){return(0,d.jsx)(e.SessionProvider,{children:a})}},88488:(a,b,c)=>{"use strict";c.d(b,{ThemeProvider:()=>f});var d=c(21124),e=c(38301);function f({children:a}){let[b,c]=(0,e.useState)(!1);return(0,d.jsx)(d.Fragment,{children:a})}},94436:(a,b,c)=>{"use strict";c.d(b,{G:()=>j});var d=c(21124),e=c(38301),f=c(19675);async function g(a){try{return await (0,f.A)(a,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,fileType:"image/webp"})}catch(b){return console.error("Error compressing image:",b),a}}async function h(a){try{return await (0,f.A)(a,{maxSizeMB:.1,maxWidthOrHeight:300,useWebWorker:!0,fileType:"image/webp"})}catch(b){return console.error("Error generating thumbnail:",b),g(a)}}async function i(a){let b=a.size/1048576;if(b>10)throw Error(`File size (${b.toFixed(2)}MB) exceeds maximum allowed size of 10MB`);let c=await g(a),d=await h(a);return{compressed:c,thumbnail:d,originalSize:a.size,compressedSize:c.size,thumbnailSize:d.size}}function j({mentorshipId:a,sessionNoteId:b,onUpload:c,currentImageCount:f,imageLimit:g=75,isAdmin:h=!1}){let[j,k]=(0,e.useState)([]),[l,m]=(0,e.useState)(!1),[n,o]=(0,e.useState)(!1),[p,q]=(0,e.useState)(f??0),[r,s]=(0,e.useState)(void 0===f),t=(0,e.useCallback)(()=>{let c=new URLSearchParams({mentorshipId:a});b&&c.append("sessionNoteId",b),fetch(`/api/images/count?${c.toString()}`,{cache:"no-store"}).then(a=>a.json()).then(a=>{q(a.count||0)}).catch(a=>{console.error("Failed to refresh image count:",a)})},[a,b]),u=h||p<g,v=h?1/0:Math.max(0,g-p);async function w(a){let b=[];for(let c of a){let a=URL.createObjectURL(c),d={original:c,compressed:c,thumbnail:c,preview:a,originalSize:c.size,compressedSize:c.size,thumbnailSize:c.size,processing:!0};b.push(d),k(a=>[...a,d]);try{let a=await i(c);k(b=>b.map(b=>b.original===c?{...b,compressed:a.compressed,thumbnail:a.thumbnail,originalSize:a.originalSize,compressedSize:a.compressedSize,thumbnailSize:a.thumbnailSize,processing:!1}:b))}catch(a){console.error("Error processing image:",a),k(b=>b.map(b=>b.original===c?{...b,processing:!1,error:a instanceof Error?a.message:"Failed to process image"}:b))}}}async function x(){if(0!==j.length){if(j.some(a=>a.processing))return void alert("Please wait for images to finish processing before uploading.");if(j.some(a=>a.error))return void alert("Some images failed to process. Please remove them and try again.");if(!h&&p+j.length>g)return void alert(`Upload would exceed the limit of ${g} images (shared across all sessions). Please remove some files.`);o(!0);try{let d=new FormData;d.append("mentorshipId",a),b&&d.append("sessionNoteId",b),j.forEach(a=>{d.append("compressed",a.compressed),d.append("thumbnails",a.thumbnail),d.append("originalSizes",a.originalSize.toString()),d.append("compressedSizes",a.compressedSize.toString()),d.append("thumbnailSizes",a.thumbnailSize.toString())});let e=await fetch("/api/images/upload",{method:"POST",body:d});if(e.ok)await e.json(),j.forEach(a=>URL.revokeObjectURL(a.preview)),k([]),t(),c&&c();else{let a=await e.json().catch(()=>({}));alert(a.error||"Failed to upload images")}}catch(a){console.error("Upload error:",a),alert("Failed to upload images. Please try again.")}finally{o(!1)}}}return(0,d.jsxs)("div",{className:"border border-gray-200 dark:border-neutral-900 rounded-md p-4 bg-white dark:bg-neutral-950",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Upload Images"}),!h&&(0,d.jsx)("div",{className:"flex items-center gap-3",children:r?(0,d.jsx)("div",{className:"px-3 py-1.5 rounded-md font-semibold text-sm bg-gray-100 dark:bg-gray-900 text-gray-600 dark:text-gray-400",children:"Loading..."}):(0,d.jsxs)("div",{className:`px-3 py-1.5 rounded-md font-semibold text-sm ${v>5?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":v>0?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400"}`,children:[p,"/",g," images (shared across all sessions)",v>0&&` • ${v} remaining`]})})]}),(0,d.jsxs)("div",{className:`rounded-lg border-2 border-dashed p-12 text-center transition-all ${u?l?"border-indigo-500 bg-indigo-50 dark:bg-indigo-950/30 dark:border-indigo-400 scale-[1.02] cursor-pointer":"border-gray-300 dark:border-neutral-700 hover:border-indigo-400 dark:hover:border-indigo-500 hover:bg-gray-50 dark:hover:bg-neutral-900/50 cursor-pointer":"border-gray-200 dark:border-neutral-800 opacity-50 cursor-not-allowed"}`,onDrop:function(a){if(a.preventDefault(),m(!1),!u)return void alert(`Image limit reached (${g} images shared across all sessions). Please delete some images before uploading more.`);let b=Array.from(a.dataTransfer.files||[]).filter(a=>a.type.startsWith("image/"));b.length>0&&(w(h?b:b.slice(0,v)),!h&&b.length>v&&alert(`Only ${v} more image(s) can be uploaded (${g} total limit shared across all sessions). ${b.length-v} file(s) were not added.`))},onDragOver:function(a){a.preventDefault(),u&&m(!0)},onDragLeave:function(){m(!1)},onClick:()=>u&&document.getElementById(`file-input-${a}`)?.click(),children:[(0,d.jsx)("div",{className:"space-y-3",children:u?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{className:"text-base font-medium text-gray-700 dark:text-neutral-300",children:"Drag and drop images here"}),(0,d.jsx)("p",{className:"text-sm text-gray-500 dark:text-neutral-500",children:"or click to browse files"}),(0,d.jsx)("p",{className:"text-xs text-gray-400 dark:text-neutral-600 mt-2",children:"Images will be compressed automatically"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{className:"text-base font-medium text-gray-500 dark:text-neutral-400",children:["Image limit reached (",g," images shared across all sessions)"]}),(0,d.jsx)("p",{className:"text-sm text-gray-400 dark:text-neutral-600",children:"Delete some images to upload more"})]})}),(0,d.jsx)("input",{id:`file-input-${a}`,type:"file",multiple:!0,accept:"image/*",onChange:function(a){if(a.target.files&&u){let b=Array.from(a.target.files).filter(a=>a.type.startsWith("image/"));b.length>0&&(w(h?b:b.slice(0,v)),!h&&b.length>v&&alert(`Only ${v} more image(s) can be uploaded (${g} total limit shared across all sessions). ${b.length-v} file(s) were not added.`))}a.target.value=""},disabled:!u,className:"hidden"})]}),j.length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"grid grid-cols-3 gap-2 mt-3",children:j.map((a,b)=>(0,d.jsxs)("div",{className:"relative",children:[a.processing?(0,d.jsx)("div",{className:"w-full h-24 rounded border border-gray-200 dark:border-neutral-800 bg-gray-100 dark:bg-neutral-900 flex items-center justify-center",children:(0,d.jsx)("div",{className:"text-xs text-gray-500 dark:text-neutral-500",children:"Processing..."})}):a.error?(0,d.jsx)("div",{className:"w-full h-24 rounded border border-red-300 dark:border-red-800 bg-red-50 dark:bg-red-950/30 flex items-center justify-center",children:(0,d.jsx)("div",{className:"text-xs text-red-600 dark:text-red-400 text-center px-1",children:"Error"})}):(0,d.jsx)("img",{src:a.preview,alt:`Preview ${b+1}`,className:"w-full h-24 object-cover rounded border border-gray-200 dark:border-neutral-800"}),(0,d.jsx)("button",{onClick:()=>{k(a=>{let c=a[b];return c&&URL.revokeObjectURL(c.preview),a.filter((a,c)=>c!==b)})},className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-red-500 hover:bg-red-600 text-white text-xs flex items-center justify-center",title:"Remove",children:"\xd7"}),a.processing&&(0,d.jsx)("div",{className:"absolute bottom-1 left-1 right-1 bg-black/50 text-white text-xs px-1 py-0.5 rounded",children:"Compressing..."})]},b))}),(0,d.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,d.jsx)("button",{onClick:x,disabled:n||j.some(a=>a.processing||a.error),className:"inline-flex items-center px-4 py-2 rounded-md bg-indigo-600 dark:bg-indigo-500 text-white hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Uploading...":`Upload ${j.length} file(s)`}),j.length>0&&(0,d.jsx)("button",{onClick:()=>{j.forEach(a=>URL.revokeObjectURL(a.preview)),k([])},className:"text-sm text-gray-600 dark:text-neutral-400 hover:text-gray-900 dark:hover:text-neutral-200",children:"Clear all"})]})]})]})}}};