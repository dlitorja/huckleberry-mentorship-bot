(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[274],{682:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),r=a(2115),i=a(6489),n=a(2619),o=a.n(n),d=a(8817),l=a(9261),c=a(4294);let h=(0,c.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),m=(0,c.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);function u(){let{data:e}=(0,i.useSession)(),[t,a]=(0,r.useState)([]),[n,c]=(0,r.useState)(null),[u,x]=(0,r.useState)([]),[g,b]=(0,r.useState)(!0),[p,y]=(0,r.useState)(!1),[k,f]=(0,r.useState)(""),[j,w]=(0,r.useState)(!1),N=(null==e?void 0:e.role)||"unknown";async function v(){if(k.trim()&&(null==n?void 0:n.id)&&!j){w(!0);try{let e=await fetch("/api/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:k.trim(),mentorship_id:n.id})});if(e.ok){let t=await e.json();a(e=>[t.session,...e]),f(""),y(!1)}else{let t=await e.json().catch(()=>({}));alert(t.error||"Failed to create note")}}catch(e){console.error("Failed to create note:",e),alert("Failed to create note")}finally{w(!1)}}}return u.filter(e=>!e.session_note_id).length,(0,r.useEffect)(()=>{!async function(){try{let t=await fetch("/api/sessions",{cache:"no-store"}),s=await t.json().catch(()=>({sessions:[]}));a(s.sessions||[]);let r=await fetch("/api/mentee/dashboard",{cache:"no-store"});if(r.ok){var e;let t=await r.json();if(c(t.mentorship||null),null==(e=t.mentorship)?void 0:e.id){let e=await fetch("/api/images?mentorshipId=".concat(t.mentorship.id),{cache:"no-store"});if(e.ok){let t=await e.json();x(t.images||[])}}}}catch(e){console.error("Failed to load sessions:",e)}finally{b(!1)}}()},[]),g?(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Your Sessions"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-neutral-400 mt-2",children:"Loading..."})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Your Sessions"}),n&&(0,s.jsxs)("button",{onClick:()=>y(!p),className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-indigo-600 dark:bg-indigo-500 text-white hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors",children:[(0,s.jsx)(h,{size:18}),(0,s.jsx)("span",{children:"Add Note"})]})]}),p&&n&&(0,s.jsxs)("div",{className:"p-4 rounded-md border border-gray-200 dark:border-neutral-900 bg-white dark:bg-neutral-950",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(m,{size:18,className:"text-gray-600 dark:text-neutral-400"}),(0,s.jsx)("h2",{className:"font-medium text-gray-900 dark:text-white",children:"Create Session Note"})]}),(0,s.jsx)("textarea",{value:k,onChange:e=>f(e.target.value),placeholder:"Write your session notes here...",className:"w-full min-h-[120px] px-3 py-2 rounded-md border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-gray-900 dark:text-white placeholder:text-gray-500 dark:placeholder:text-neutral-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-indigo-400",disabled:j}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-3",children:[(0,s.jsx)("button",{onClick:v,disabled:!k.trim()||j,className:"px-4 py-2 rounded-md bg-indigo-600 dark:bg-indigo-500 text-white hover:bg-indigo-700 dark:hover:bg-indigo-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Creating...":"Create Note"}),(0,s.jsx)("button",{onClick:()=>{y(!1),f("")},disabled:j,className:"px-4 py-2 rounded-md border border-gray-300 dark:border-neutral-700 bg-white dark:bg-neutral-900 text-gray-700 dark:text-neutral-300 hover:bg-gray-50 dark:hover:bg-neutral-800 transition-colors disabled:opacity-50",children:"Cancel"})]})]}),n&&(0,s.jsx)("div",{children:(0,s.jsx)(d.G,{mentorshipId:n.id,onUpload:function(){(null==n?void 0:n.id)&&fetch("/api/images?mentorshipId=".concat(n.id),{cache:"no-store"}).then(e=>e.json()).then(e=>x(e.images||[])).catch(e=>console.error("Failed to reload images:",e))},imageLimit:75,isAdmin:"admin"===N})}),u.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Uploaded Images"}),(0,s.jsx)(l.i,{images:u,onDelete:function(e){x(t=>t.filter(t=>t.id!==e))},showDelete:!0,mentorshipId:null==n?void 0:n.id})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Session Notes"}),(0,s.jsxs)("ul",{className:"space-y-3",children:[t.map(e=>(0,s.jsxs)("li",{className:"p-4 rounded-md border border-gray-200 dark:border-neutral-900 bg-white dark:bg-neutral-950 hover:shadow-sm transition-shadow",children:[(0,s.jsx)(o(),{href:"/sessions/".concat(e.id),className:"font-medium text-gray-900 dark:text-white hover:underline",children:new Date(e.created_at).toLocaleString()}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-neutral-400 line-clamp-2 mt-1",children:e.notes||"No notes yet."})]},e.id)),0===t.length&&(0,s.jsxs)("li",{className:"p-4 rounded-md border border-gray-200 dark:border-neutral-900 bg-white dark:bg-neutral-950",children:[(0,s.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:"No sessions found"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-neutral-400 mt-1",children:n?"Create your first session note using the 'Add Note' button above, or wait for your instructor to add notes.":"Once your instructor adds notes via Discord or the portal, they will appear here."})]})]})]})]})}},3984:(e,t,a)=>{Promise.resolve().then(a.bind(a,682))}},e=>{e.O(0,[489,619,571,661,441,255,358],()=>e(e.s=3984)),_N_E=e.O()}]);